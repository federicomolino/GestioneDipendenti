<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>NuovoUtente</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/Navbar.css">
</head>
<body>
<!--importo navbar-->
<div th:replace="~{Navbar/navbar :: navbar}"></div>
<div class="container">
  <div class="row">
    <div class="col-4">
      <h2>Nuovo Dipendente</h2>
    </div>

    <hr>

    <div th:if="${successMessage}" class="alert alert-success d-flex justify-content-between mt-2 col-4 mx-auto">
      <span th:text="${successMessage}">Utente eliminato correttamente!</span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div th:if="${errorMessage}" class="alert alert-danger d-flex justify-content-between mt-2 col-4 mx-auto">
      <span th:text="${errorMessage}">Errore generico</span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div th:if="${warningMessage}" class="alert alert-warning d-flex justify-content-between mt-2 col-4 mx-auto">
      <span th:text="${warningMessage}">Info Utente</span>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

      <!--I miei dati-->
      <div class="d-flex justify-content-evenly">
        <div class="mt-3 col-4">
          <div class="card shadow-sm">
            <form method="post" th:object="${formNewUtente}" th:action="@{/utente/nuovoUtente}">
              <div class="card-header bg-success text-white d-flex justify-content-between">
                <h5 class="mb-0">Dati Nuovo Dipendente</h5>
                <a href="editUtente" class="text-white">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                    <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                    <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
                </svg>
                </a>
              </div>
              <div class="card-body">
                <div class="row mb-3">
                  <labal class="col-3 fw-bold mt-2">Nome <span class="text-danger">*</span></labal>
                  <input type="text" id="nome" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{nome}">
                  <strong th:if="${#fields.hasErrors('nome')}" class="text-danger" th:errors="*{nome}"></strong>
                </div>
                <div class="row mb-3">
                  <labal class="col-4 fw-bold mt-2">Cognome<span class="text-danger"> *</span></labal>
                  <input type="text" id="cognome" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{cognome}">
                  <strong th:if="${#fields.hasErrors('cognome')}" class="text-danger" th:errors="*{cognome}"></strong>
                </div>
                <div class="row mb-3">
                  <labal class="col-6 fw-bold mt-2">Data di Nascita <span class="text-danger">*</span></labal>
                  <input type="date" id="dataDiNascita" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{dataDiNascita}">
                  <strong th:if="${#fields.hasErrors('dataDiNascita')}" class="text-danger" th:errors="*{dataDiNascita}"></strong>
                </div>
                <div class="row mb-3">
                  <labal class="col-5 fw-bold mt-2">Luogo di Nascita <span class="text-danger">*</span></labal>
                  <input type="text" id="luogoDiNascita" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{luogoDiNascita}">
                  <strong th:if="${#fields.hasErrors('luogoDiNascita')}" class="text-danger" th:errors="*{luogoDiNascita}"></strong>
                </div>

                <div class="row mb-3">
                  <labal class="col-5 fw-bold mt-2">Email <span class="text-danger">*</span></labal>
                  <input type="text" id="email" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{email}">
                  <strong th:if="${#fields.hasErrors('email')}" class="text-danger" th:errors="*{email}"></strong>
                </div>

                <div class="row mb-3">
                  <labal class="col-5 fw-bold mt-2">Username <span class="text-danger">*</span></labal>
                  <input type="text" id="username" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{username}">
                  <strong th:if="${#fields.hasErrors('username')}" class="text-danger" th:errors="*{username}"></strong>
                </div>

                <div class="row mb-3">
                  <labal class="col-5 fw-bold mt-2">Password <span class="text-danger">*</span></labal>
                  <input type="password" id="password" class="form-control col-sm" aria-describedby="passwordHelpInline"
                         th:field="*{password}">
                </div>
                <hr>
                <div>
                  <strong>Ruoli Utente</strong>

                  <div class="form-check small mt-2">
                    <input class="form-check-input" type="checkbox" value="ADMIN" id="checkDefault" name="ruolo">
                    <label class="form-check-label" for="checkDefault">ADMIN</label>
                  </div>

                  <div class="form-check small">
                    <input class="form-check-input" type="checkbox" value="USER" id="checkChecked" checked
                           name="ruolo">
                    <label class="form-check-label" for="checkChecked">USER</label>
                  </div>
                  <div class="form-check small">
                    <input class="form-check-input" type="checkbox" value="SERVICE" id="checkCheckedService"
                           name="ruolo">
                    <label class="form-check-label" for="checkChecked"
                           title="Da inserire nel caso in cui si usufruisca delle API">SERVICE</label>
                  </div>

                </div>
              </div>

              <div class="mb-3 me-3 text-end">
                <button type="submit" class="btn btn-success">Aggiungi</button>
              </div>
            </form>
          </div>
        </div>

        <!--Lista utenti-->
        <div class="ms-5 col-4">
          <div class="mt-3">
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                  <h5 class="mb-0">Utenti presenti</h5>
                </div>

                <div th:if="${listUtenti.isEmpty}" class="alert alert-warning d-flex justify-content-between mt-2">
                  <span>Nessun Utente presente</span>
                  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>

                <div th:unless="${listUtenti.isEmpty}">
                  <div th:each="utenti : ${listUtenti}">
                    <form method="post" th:object="${formUtentePresenti}" th:action="@{/utente/cancellaUtente/{id}(id=${utenti.IdUtente})}">
                      <ul class="list-group">
                          <li class="list-group-item d-flex justify-content-between">

                            <span th:text="${utenti.username}">federico.molino</span>
                            <!--Contratto Scaduto-->
                            <div th:if="${utentiConContrattoScaduto.contains(utenti.idUtente)}"
                                 th:id="'contrattoScaduto_' + ${utenti.idUtente}"
                                 title="Contratto Scaduto">
                              <a  th:href="@{/utente/utente-contratto/contratti-scaduti}" class="text-danger" title="Visualizzi contratti scaduti">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle" viewBox="0 0 16 16">
                                  <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
                                  <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
                                </svg>
                              </a>
                            </div>

                            <div class="col-4 d-flex justify-content-evenly">

                              <a type="submit" class="btn btn-sm border-dark" sec:authorize="hasAuthority('ADMIN')"
                                 title="Vedi contratto dipendente"
                                 th:href="@{utente-contratto/contratto/edit/{IdUtente}(IdUtente=${utenti.IdUtente})}">
                                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQgLnJmmn5Dbw6G7LwfCU9946DKmpRlaPxaQg&s" style="width: 16px; height: 16px;">
                              </a>

                              <a type="submit" class="btn btn-sm border-dark" sec:authorize="hasAuthority('ADMIN')"
                                      title="Crea contratto" th:href="@{utente-contratto/contratto/{IdUtente}(IdUtente=${utenti.IdUtente})}">
                                <img src="https://cdn-icons-png.flaticon.com/512/2666/2666501.png" style="width: 16px; height: 16px;">
                              </a>

                              <button type="submit" class="btn btn-danger btn-sm" sec:authorize="hasAuthority('ADMIN')"
                                      onclick="return confirm('Vuoi cancellare l\'utente?')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
                                  <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
                                </svg>
                              </button>
                            </div>
                          </li>
                      </ul>
                    </form>
                  </div>
                </div>
            </div>
        </div>
      </div>
  </div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>